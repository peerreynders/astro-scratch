---
// file: src/pages/blog/[...page].astro
import type { GetStaticPathsOptions } from 'astro';
import { fromPosts } from '../../lib/collections';
import { compiledContent, frontmatter } from '../../data/blog.md';
import Feed from '../../layouts/Feed.astro';

export async function getStaticPaths(options: GetStaticPathsOptions) {
	const { pageSize } = frontmatter;

	const posts = await fromPosts();
	return options.paginate(posts, { pageSize });
}

const summary = compiledContent();
const { anchor, nextLabel, previousLabel, title } = frontmatter;
const { page } = Astro.props;
const pagination = {
	anchor,
	nextHref: page.url.next,
	nextLabel,
	previousHref: page.url.prev,
	previousLabel,
};
---

<Feed
	title={title}
	summary={summary}
	posts={page.data}
	pagination={pagination}
/>
